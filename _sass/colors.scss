$color-light-primary: #035825;
$color-light-on-primary: #CCEFD4;
$color-light-primary-container: #86E39C;
$color-light-on-primary-container: #08581B;

$color-light-surface-0: #ffffff;
$color-light-surface-1: #ECFEEC;
$color-light-surface-2: #E1FAE1;

$color-light-on-surface: #000000;
$color-light-on-surface-less: #444444;

$color-light-outline: #666666;
$color-light-outline-less: #999999;

$color-dark-primary: #A9DFB4;
$color-dark-on-primary: #002908;
$color-dark-primary-container: #2C5E35;
$color-dark-on-primary-container: #DFF9DC;

$color-dark-surface-0: #000000;
$color-dark-surface-1: #01230C;
$color-dark-surface-2: #0F2E1A;

$color-dark-on-surface: #ffffff;
$color-dark-on-surface-less: #bbbbbb;

$color-dark-outline: #aaaaaa;
$color-dark-outline-less: #999999;

$aaa-normal-text-ratio: 7;
$aaa-large-text-ratio: 4.5;
$ui-ratio: 3;

@function srgb_to_linear($val) {
    @if $val < 0.3928 {
        @return $val / 12.92;
    } @else {
        $thingy: (($val + 0.055) / 1.055);
        // $thingy needs to be raised to the power of 2.4, but that is not really possible with built-in sass
        // so instead it is approximated just by squaring
        // TODO: fix this when jekyll supports sass modules
        @return $thingy * $thingy;
    }
}

@function relative_luminance($color) {
    $r: srgb_to_linear(red($color) / 255.0);
    $g: srgb_to_linear(green($color) / 255.0);
    $b: srgb_to_linear(blue($color) / 255.0);

    @return 0.2126 * $r + 0.7152 * $g + 0.0722 * $b;
}

@function contrast_ratio($c1, $c2) {
    $c1-luminance: relative_luminance($c1);
    $c2-luminance: relative_luminance($c2);

    @return (max($c1-luminance, $c2-luminance) + 0.05) / (min($c1-luminance, $c2-luminance) + 0.05);
}

@function ensure_contrast_ratio($c1, $c2, $needed-ratio) {
    $actual-ratio: contrast_ratio($c1, $c2);
    @if $actual-ratio < $needed-ratio {
        @warn("contrast ratio between #{$c1} and #{$c2} is #{$actual-ratio}, not #{$needed-ratio}");
        @return false;
    }
    @return true;
}

@debug ensure_contrast_ratio($color-light-primary, $color-light-surface-0, $aaa-normal-text-ratio);
@debug ensure_contrast_ratio($color-light-primary, $color-light-surface-1, $aaa-normal-text-ratio);
@debug ensure_contrast_ratio($color-light-primary, $color-light-surface-2, $aaa-normal-text-ratio);

@debug ensure_contrast_ratio($color-light-on-primary, $color-light-primary, $aaa-normal-text-ratio);
@debug ensure_contrast_ratio($color-light-on-primary-container, $color-light-primary-container, $aaa-normal-text-ratio);
@debug ensure_contrast_ratio($color-light-on-surface, $color-light-surface-0, $aaa-normal-text-ratio);
@debug ensure_contrast_ratio($color-light-on-surface-less, $color-light-surface-0, $aaa-normal-text-ratio);
@debug ensure_contrast_ratio($color-light-on-surface, $color-light-surface-1, $aaa-normal-text-ratio);
@debug ensure_contrast_ratio($color-light-on-surface-less, $color-light-surface-1, $aaa-normal-text-ratio);
@debug ensure_contrast_ratio($color-light-on-surface, $color-light-surface-2, $aaa-normal-text-ratio);
@debug ensure_contrast_ratio($color-light-on-surface-less, $color-light-surface-2, $aaa-normal-text-ratio);

@debug ensure_contrast_ratio($color-light-outline, $color-light-surface-0, $ui-ratio);
@debug ensure_contrast_ratio($color-light-outline, $color-light-surface-1, $ui-ratio);
@debug ensure_contrast_ratio($color-light-outline, $color-light-surface-2, $ui-ratio);

@debug ensure_contrast_ratio($color-dark-primary, $color-dark-surface-0, $aaa-normal-text-ratio);
@debug ensure_contrast_ratio($color-dark-primary, $color-dark-surface-1, $aaa-normal-text-ratio);
@debug ensure_contrast_ratio($color-dark-primary, $color-dark-surface-2, $aaa-normal-text-ratio);

@debug ensure_contrast_ratio($color-dark-on-primary, $color-dark-primary, $aaa-normal-text-ratio);
@debug ensure_contrast_ratio($color-dark-on-primary-container, $color-dark-primary-container, $aaa-normal-text-ratio);
@debug ensure_contrast_ratio($color-dark-on-surface, $color-dark-surface-0, $aaa-normal-text-ratio);
@debug ensure_contrast_ratio($color-dark-on-surface-less, $color-dark-surface-0, $aaa-normal-text-ratio);
@debug ensure_contrast_ratio($color-dark-on-surface, $color-dark-surface-1, $aaa-normal-text-ratio);
@debug ensure_contrast_ratio($color-dark-on-surface-less, $color-dark-surface-1, $aaa-normal-text-ratio);
@debug ensure_contrast_ratio($color-dark-on-surface, $color-dark-surface-2, $aaa-normal-text-ratio);
@debug ensure_contrast_ratio($color-dark-on-surface-less, $color-dark-surface-2, $aaa-normal-text-ratio);

@debug ensure_contrast_ratio($color-dark-outline, $color-dark-surface-0, $ui-ratio);
@debug ensure_contrast_ratio($color-dark-outline, $color-dark-surface-1, $ui-ratio);
@debug ensure_contrast_ratio($color-dark-outline, $color-dark-surface-2, $ui-ratio);

:root {
    --color-primary: #{$color-light-primary};
    --color-on-primary: #{$color-light-on-primary};
    --color-primary-container: #{$color-light-primary-container};
    --color-on-primary-container: #{$color-light-on-primary-container};
    --color-surface-0: #{$color-light-surface-0};
    --color-surface-1: #{$color-light-surface-1};
    --color-surface-2: #{$color-light-surface-2};
    --color-on-surface: #{$color-light-on-surface};
    --color-on-surface-less: #{$color-light-on-surface-less};
    --color-outline: #{$color-light-outline};
    --color-outline-less: #{$color-light-outline-less};
}
@media (prefers-color-scheme: dark) {
   :root {
        --color-primary: #{$color-dark-primary};
        --color-on-primary: #{$color-dark-on-primary};
        --color-primary-container: #{$color-dark-primary-container};
        --color-on-primary-container: #{$color-dark-on-primary-container};
        --color-surface-0: #{$color-dark-surface-0};
        --color-surface-1: #{$color-dark-surface-1};
        --color-surface-2: #{$color-dark-surface-2};
        --color-on-surface: #{$color-dark-on-surface};
        --color-on-surface-less: #{$color-dark-on-surface-less};
        --color-outline: #{$color-dark-outline};
        --color-outline-less: #{$color-dark-outline-less};
   }
}

$color-primary: var(--color-primary);
$color-on-primary: var(--color-on-primary);
$color-primary-container: var(--color-primary-container);
$color-on-primary-container: var(--color-on-primary-container);
$color-surface-0: var(--color-surface-0);
$color-surface-1: var(--color-surface-1);
$color-surface-2: var(--color-surface-2);
$color-on-surface: var(--color-on-surface);
$color-on-surface-less: var(--color-on-surface-less);
$color-outline: var(--color-outline);
$color-outline-less: var(--color-outline-less);
